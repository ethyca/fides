"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TcfEuV2=void 0;const DecodingError_js_1=require("../error/DecodingError.js"),TcfEuV2Field_js_1=require("../field/TcfEuV2Field.js"),TcfEuV2CoreSegment_js_1=require("../segment/TcfEuV2CoreSegment.js"),TcfEuV2PublisherPurposesSegment_js_1=require("../segment/TcfEuV2PublisherPurposesSegment.js"),TcfEuV2VendorsAllowedSegment_js_1=require("../segment/TcfEuV2VendorsAllowedSegment.js"),TcfEuV2VendorsDisclosedSegment_js_1=require("../segment/TcfEuV2VendorsDisclosedSegment.js"),AbstractLazilyEncodableSection_js_1=require("./AbstractLazilyEncodableSection.js");class TcfEuV2 extends AbstractLazilyEncodableSection_js_1.AbstractLazilyEncodableSection{constructor(e){super(),e&&e.length>0&&this.decode(e)}getId(){return TcfEuV2.ID}getName(){return TcfEuV2.NAME}getVersion(){return TcfEuV2.VERSION}initializeSegments(){let e=[];return e.push(new TcfEuV2CoreSegment_js_1.TcfEuV2CoreSegment),e.push(new TcfEuV2PublisherPurposesSegment_js_1.TcfEuV2PublisherPurposesSegment),e.push(new TcfEuV2VendorsAllowedSegment_js_1.TcfEuV2VendorsAllowedSegment),e.push(new TcfEuV2VendorsDisclosedSegment_js_1.TcfEuV2VendorsDisclosedSegment),e}decodeSection(e){let s=this.initializeSegments();if(null!=e&&0!==e.length){let t=e.split(".");for(let e=0;e<t.length;e++){let u=t[e];if(0!==u.length){let c=u.charAt(0);if(c>="A"&&c<="H")s[0].decode(t[e]);else if(c>="I"&&c<="P")s[3].decode(t[e]);else if(c>="Q"&&c<="X")s[2].decode(t[e]);else{if(!(c>="Y"&&c<="Z"||c>="a"&&c<="f"))throw new DecodingError_js_1.DecodingError("Unable to decode TcfEuV2 segment '"+u+"'");s[1].decode(t[e])}}}}return s}encodeSection(e){let s=[];if(e.length>=1){s.push(e[0].encode()),this.getFieldValue(TcfEuV2Field_js_1.TcfEuV2Field.IS_SERVICE_SPECIFIC)?e.length>=2&&s.push(e[1].encode()):e.length>=2&&(s.push(e[2].encode()),e.length>=3&&s.push(e[3].encode()))}return s.join(".")}setFieldValue(e,s){if(super.setFieldValue(e,s),e!==TcfEuV2Field_js_1.TcfEuV2Field.CREATED&&e!==TcfEuV2Field_js_1.TcfEuV2Field.LAST_UPDATED){let e=new Date;super.setFieldValue(TcfEuV2Field_js_1.TcfEuV2Field.CREATED,e),super.setFieldValue(TcfEuV2Field_js_1.TcfEuV2Field.LAST_UPDATED,e)}}}exports.TcfEuV2=TcfEuV2,TcfEuV2.ID=2,TcfEuV2.VERSION=2,TcfEuV2.NAME="tcfeuv2";