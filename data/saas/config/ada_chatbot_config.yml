saas_config:
  fides_key: <instance_fides_key>
  name: Ada Chatbot
  type: ada_chatbot
  description: A sample schema representing the Ada Chatbot connector for Fides
  version: 0.1.0

  connector_params:
    - name: domain
      default_value: demo-sandbox-ethyca.ada.support
    - name: export_access_token
    - name: compliance_access_token

  external_references:
    - name: chatter_id

  client_config:
    protocol: https
    host: <domain>
    authentication:
      strategy: bearer
      configuration:
        token: <export_access_token>

  test_request:
    method: GET
    path: /data_api/v1.2/conversations
    query_params:
      - name: created_since
        value: '2023-06-28T17:59:28.201000'
      - name: page_size
        value: '100'

  endpoints:
    - name: conversations
      requests:
        read:
          method: GET
          path: /data_api/v1.2/conversations
          query_params:
            - name: created_since
              value: '2023-06-28T17:59:28.201000'
            - name: page_size
              value: '100'
          data_path: data
          postprocessors:
            - strategy: filter
              configuration:
                field: chatter_id
                value: '={{$externalReferences["chatter_id"]}}'
          param_values:
            - name: placeholder
              identity: email
    - name: messages
      requests:
        read:
          method: GET
          path: /data_api/v1.2/messages
          query_params:
            - name: created_since
              value: '2023-06-28T17:59:28.201000'
            - name: page_size
              value: '100'
            - name: conversation_id
              value: <conversations__id>
          data_path: data
          postprocessors:
            - strategy: filter
              configuration:
                field: chatter_id
                value: '={{$externalReferences["chatter_id"]}}'
          pagination:
            strategy: cursor
            configuration:
              cursor_param: after
              field: _id
          param_values:
            - name: placeholder
              identity: email
            - name: conversations__id
              references:
                - dataset: <instance_fides_key>
                  field: conversations._id
                  direction: from
    - name: delete_chatter_data
      requests:
        delete:
          method: POST
          path: /api/v1/data-subject-request
          client_config:
            protocol: https
            host: <domain>
            authentication:
              strategy: bearer
              configuration:
                token: <compliance_access_token>
          body: |
            {
             "type": "ERASURE",
             "email": "<email>"
            }
          param_values:
            - name: email
              identity: email