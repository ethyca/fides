saas_config:
  fides_key: <instance_fides_key>
  name: Segment
  type: segment
  description: A sample schema representing the Segment connector for Fides
  user_guide: https://docs.ethyca.com/user-guides/integrations/saas-integrations/segment
  version: 0.0.6

  connector_params:
    - name: domain
      default_value: platform.segmentapis.com
      description: Your Segment API URL
    - name: workspace
      description: Your Segment workspace ID
    - name: access_token
      description: Your Segment access token.
      label: Access token
      sensitive: True
    - name: namespace_id
      label: Space ID
      description: Your Segment space ID

  client_config:
    protocol: https
    host: <domain>
    authentication:
      strategy: bearer
      configuration:
        token: <access_token>

  test_request:
    method: GET
    path: /v1beta/workspaces/

  data_protection_request:
    method: POST
    path: /v1beta/workspaces/<workspace_name>/regulations
    headers:
      - name: Content-Type
        value: application/json
    param_values:
      - name: workspace_name
        connector_param: workspace
      - name: user_id
        references:
          - dataset: <instance_fides_key>
            field: traits.user_id
            direction: from
    body: |
      {
        "regulation_type": "Suppress_With_Delete",
        "attributes": {
          "name": "userId",
          "values": ["<user_id>"]
        }
      }
    client_config:
      protocol: https
      host: <domain>
      authentication:
        strategy: bearer
        configuration:
          token: <access_token>
